# Connect Service — Caching Strategy

Основная цель кеширования — ускорить:

- работу Rule Engine (минимизировать обращения к БД за правилами),
- валидацию и обработку событий.

## 1. Кеш правил наград (RewardRule)

- Ключи:
  - `connect:rules_by_event_type:{event_type}`
- Содержимое:
  - список активных правил для данного `event_type`,
  - возможно, уже отсортированный по `priority`.
- TTL:
  - достаточно большой (минуты/часы), либо бесконечный с инвалидацией при изменении.
- Инвалидация:
  - при создании/обновлении/деактивации правила:
    - сбрасываются кеши по соответствующему `event_type`.

Это позволяет Rule Engine в большинстве случаев:

- не ходить в БД за правилами,
- работать чисто в памяти + Redis.

---

## 2. Кеш конфигураций кампаний

Если используется модель `Campaign`:

- можно кешировать:
  - активные кампании,
  - настройки лимитов/коэффициентов.
- Ключи:
  - `connect:campaign:{campaign_id}`

---

## 3. Что не кешируется

- `EconomicEvent` и `RewardAction`:
  - это журнальные записи (log/audit),
  - доступ к ним нужен реже и преимущественно через индексы БД.

---

## 4. Технология

- Redis как основной кеш-слой:
  - быстрый доступ,
  - поддержка TTL и явной инвалидации.
