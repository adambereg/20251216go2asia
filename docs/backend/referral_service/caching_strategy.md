# Referral Service — Caching Strategy

## Цели

- Ускорить доступ к данным кампаний (часто нужны на чтение).
- Ускорить выдачу пользовательской статистики.

---

## Что кешируем

1. **Активные кампании**
   - Ключ: `referral:campaign:{code}`
   - TTL: 5–10 минут.
   - Инвалидируется при изменении кампании или статуса.

2. **Пользовательская статистика**
   - Ключ: `referral:stats:user:{user_id}`
   - TTL: 1–5 минут.
   - Инвалидируется по событиям:
     - создание нового `ReferralEvent`,
     - изменение `ReferralReward` для данного пользователя.

---

## Что не кешируем

- Низкоуровневые журналы событий (`ReferralEvent`, `ReferralReward`) — они пишутся в БД и используются аналитикой отдельно.

---

## Технология

- Redis как основной кеш.
- Возможен локальный in-memory кеш для самых часто читаемых кампаний на уровне инстанса.
