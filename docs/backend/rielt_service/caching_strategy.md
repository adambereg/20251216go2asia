# Rielt Service — Caching Strategy

## Цели

- Ускорить выдачу каталога и карточек объявлений.
- Снизить нагрузку на БД при повторяющихся запросах.

---

## Что кешируем

### 1. Карточки объявлений (by id)

- Ключ: `rielt:listing:{id}`
- Значение:
  - основные поля объявления,
  - базовые данные объекта (`country_id`, `city_id`, `area_name`) и `is_partner_object`.
- TTL: 5–15 минут.
- Инвалидация:
  - при обновлении/архивации объявления.

### 2. Результаты каталога

- Ключ: `rielt:catalog:{hash(filters+page)}`.
- Значение:
  - список `listing_id` + метаданные (кол-во total).
- TTL: 1–5 минут.
- Инвалидация:
  - при изменении объявлений в соответствующем регионе/городе (на старте можно не делать сложную инвалидацию, полагаться на короткий TTL).

### 3. Статистика просмотров

- Инкременты просмотров можно сначала складывать в Redis:
  - `rielt:listing:views:daily:{listing_id}`,
- периодически (batch job) агрегировать в основную таблицу `ListingViewStat`.

---

## Что не кешируем

- Персональные списки заявок и избранного:
  - чувствительны к изменениям,
  - сравнительно небольшие выборки.

---

## Технология

- Redis (общий кластер кешей).
- Локальный in-memory кеш для горячих карточек (при необходимости).

