# Quest Service — Обзор

## Назначение

**Quest Service** — микросервис квестов и миссий в экосистеме Go2Asia.

Он отвечает за:

- хранение и управление **квестами и миссиями**;
- структуру квеста: шаги/чекпоинты, условия прохождения;
- создание / публикацию / покупку квеста пользователями;
- фиксацию прогресса и завершения;
- запуск наград (Points / NFT / ваучеры) через интеграцию с другими сервисами.

Квесты создаются:

- **PRO-спейсерами** (основной сценарий),
- **админами** (стартовые / промо-квесты).

Обычные пользователи (Spacers) квесты не создают.

---

## Типы квестов в MVP

Поддерживаемая типология (может комбинироваться):

1. **Одиночные квесты** — один пользователь проходит квест сам.
2. **Групповые квесты** — несколько участников (party), прогресс может быть общий.
3. **Локационные квесты**:
   - чекпоинты привязаны к `atlas_place_id` и/или GPS-координатам.
4. **Онлайн-миссии** (без географии):
   - задания “написать отзыв”, “опубликовать 3 фото”, “ответить на вопросы” и т.п.
5. **Квесты от PRO-гуру**:
   - созданы PRO, привязаны к конкретным городам / маршрутам / RF-партнёрам.
6. **Квесты от бизнес-партнёров RF**:
   - включают визиты в заведения Russian Friendly;
   - могут использовать обычные ваучеры и **Премиум-ваучеры** (как обязательные или опциональные).
7. **Линейные большие квесты** (“кампании”):
   - многоэтапные истории-путешествия с последовательными шагами.
8. **Миссии дня / недели**:
   - шаблонные квесты, генерируемые/планируемые регулярно (на уровне конфигурации).

---

## Награды и экономика

### Покупка квеста

- Покупать квесты могут **только VIP-спейсеры и выше**.
- Оплата квеста — **только в Points**.
- При покупке:
  - Points списываются у пользователя (через Points Service);
  - **PRO-спейсер**, создавший квест, получает вознаграждение в Points за каждую покупку;
  - Quest Service фиксирует факт покупки (QuestRun/QuestPurchase).

### Премиум-ваучеры внутри квеста

- Шаги квеста могут требовать **покупки Премиум-ваучера** бизнес-партнёра.
- Логика:
  - покупка Премиум-ваучера → Voucher Service + Token/NFT;
  - PRO-спейсер дополнительно получает Points (или G2A) за покупку Премиум-ваучера — это на стороне Voucher/Token/Points;
  - Quest Service хранит только ссылку на требуемый `premium_voucher_id` в шаге квеста.

### Награды за прохождение

- Путешественник (пользователь):
  - получает **NFT-награду** за успешное прохождение квеста (через NFT Service);
  - опционально может получать дополнительные Points (конфигурируемо).
- PRO-спейсер:
  - получает Points за **покупку квеста**;
  - дополнительное вознаграждение за покупки премиум-ваучеров — через Voucher/Points.

Quest Service не хранит балансы Points/G2A/NFT, а только:

- конфигурацию наград на уровне квеста;
- факты покупок и завершений, которые используют другие сервисы.

---

## Чекпоинты и верификация

Типы чекпоинтов:

1. **GPS-чек** — нахождение в нужной зоне по координатам.
2. **Фото-чек** — загрузка фото (связано с Media/Content).
3. **QR/код-чек** — скан QR или ввод кода.
4. **Q&A-чек** — ответ на вопрос / викторину.

Все четыре типа **автопроверяются**:

- GPS — проверка радиуса и времени;
- Фото — базовая проверка факта загрузки (в будущем AI-анализ);
- QR/код — совпадение кода;
- Q&A — сравнение с правильными ответами.

Дополнительно:

- Финальное условие квеста — **публикация поста-отчёта в тематической группе Space Asia**.
- Этот пост может быть:
  - создан вручную пользователем;
  - позже — создан/помощен автоматически (см. roadmap).
- **PRO-спейсер** подтверждает финальную публикацию вручную (moderation-flag),
  после чего NFT-награда может быть активирована.

---

## Роль в экосистеме

Quest Service связывает:

- **RF Service** — партнёры и их заведения, к которым привязаны квесты;
- **Atlas Asia** — города/места, где проходят квесты;
- **Guru Service** — PRO-спейсеры как авторы и ведущие квестов;
- **Points Service** — оплата квестов и вознаграждения в Points;
- **Voucher Service** — покупка и использование ваучеров/Премиум-ваучеров как части квеста;
- **NFT / Token / Blockchain Gateway** — NFT-награды и опциональные ончейн-активности;
- **Content Service (Space Asia)** — публикации отчетов и контента по квестам.

А также интегрируется в UI:

- вкладка **“Городские прогулки и приключения”** в Atlas на странице города;
- ленты тематических групп Space Asia;
- раздел Quest Asia / go2asia.quest.
