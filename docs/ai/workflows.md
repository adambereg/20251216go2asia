# Go2Asia — AI Workflows Overview  
Документ описывает ВСЕ рабочие процессы мультиагентной разработки Go2Asia.  
Он служит центральной точкой, из которой ИИ-агенты получают понимание:

- как устроен общий pipeline разработки,
- как вести итерации,
- как выбирать агента под задачу (auto-routing),
- как работает review-pipeline,
- когда и как включаются режимы ревью (sub-agent mode),
- как Оркестратор координирует работу всех агентов.

Этот документ должен читаться **перед выполнением любых сложных задач** (особенно архитектура, backend, планирование, токеномика, микросервисы).

---

# 1. Структура AI-workflow системы Go2Asia

Все рабочие процессы распределены по отдельным файлам:

| Файл | Назначение |
|------|------------|
| **pipeline_overview.md** | Главный end-to-end процесс: путь от идеи → до релиза |
| **iteration_rules.md** | Правила итераций, фаз, спринтов, завершения работ |
| **agent_lifecycle.md** | Как ИИ-агенты принимают задачи, читают контекст, принимают решения |
| **auto_routing.md** | Алгоритм выбора агента в зависимости от типа задачи |
| **review_pipeline.md** | Когда и почему запускаются режимы ревью (review-mode) |
| **roles/** | Детальное описание всех 10 основных агентов и их review-режимов |
| **decisions/** | ADR — архитектурные решения, обязательные к учёту |

Каждый файл решает свой слой процесса.  
Этот документ — **карта**, которая связывает их в единую систему.

---

# 2. Главные workflow-контуры

Go2Asia использует 4 ключевых рабочих контура:

1. **Development Pipeline** (описан в `pipeline_overview.md`)  
2. **Iteration Cycle** (описан в `iteration_rules.md`)  
3. **Agent Lifecycle** (описан в `agent_lifecycle.md`)  
4. **Review Pipeline** (описан в `review_pipeline.md`)

Эти контуры работают параллельно и формируют полный мультиагентный процесс.

---

# 3. Как ИИ-агенты должны использовать workflows

Каждый агент, получая задачу, выполняет три шага:

## Шаг 1 — Определить тип задачи  
Сначала агент анализирует саму задачу:

- Это ТЗ?
- Архитектура?
- План?
- Backend-код?
- Frontend?
- Документация?
- Решение в токеномике?
- Создание микросервиса?
- CI/CD?
- Обновление OpenAPI?

## Шаг 2 — Открыть соответствующие workflow-файлы  
Cursor/агент должен автоматически открывать нужные файлы:

| Тип задачи | Какие файлы читать |
|------------|--------------------|
| Техническое задание | `iteration_rules.md`, `review_pipeline.md` |
| Архитектура | `pipeline_overview.md`, `review_pipeline.md`, ADR |
| Планирование | `iteration_rules.md`, `review_pipeline.md` |
| Backend | `pipeline_overview.md`, `review_pipeline.md` |
| Frontend | `pipeline_overview.md`, `design_tokens.md`, `ui_kit.md` |
| Микросервисы | `microservices.md`, `api_architecture.md`, ADR |
| API | `api_architecture.md`, `openapi.yaml` |
| Токеномика | `tokenomics/*.md`, ADR |
| CI/CD | `docs/ops/*.md` |

## Шаг 3 — Проверить, нужен ли режим ревью  
После создания артефакта:

- создаётся ТЗ → запускается review-mode у аналитика  
- создаётся архитектура → запускается review-mode у архитектора  
- создаётся план → запускается review-mode у планировщика  
- создаётся backend-код → запускается code-review  

Правила — в `review_pipeline.md`.

---

# 4. Роль Оркестратора в workflow

Оркестратор — главный управляющий процессом.  
Он обязан:

- анализировать задачу и выбирать агента согласно `auto_routing.md`,
- контролировать выполнение pipeline согласно `pipeline_overview.md`,
- следить за завершённостью итерации (DoD) согласно `iteration_rules.md`,
- требовать ревью, когда оно необходимо, согласно `review_pipeline.md`,
- удерживать консистентность всего проекта.

Оркестратор не должен выполнять работу сам — только направлять агентов.

---

# 5. Где участвуют review-режимы (sub-agent modes)

Review-режимы встроены в общий pipeline. Они включаются:

| Артефакт | Кто ревьюит | Когда |
|----------|--------------|--------|
| ТЗ | Requirements Analyst (review-mode) | После завершения ТЗ |
| Архитектура | Architect (review-mode) | После завершения архитектуры |
| План | Planner (review-mode) | При завершении фазы/спринта/этапа |
| Код | Backend Dev + QA + Security (review-mode) | Перед merge больших изменений |

Любая задача считается незаконченой, если ревью не прошло.

Подробнее — в `review_pipeline.md`.

---

# 6. Workflow истекает в результаты

Каждый шаг мультиагентки должен создавать следы:

| Тип артефакта | Директория |
|---------------|------------|
| ТЗ | `docs/modules/...` или `docs/backend/...` |
| Архитектура | `docs/architecture/` или `docs/backend/**/architecture.md` |
| План | `docs/plans/` |
| Ревью ТЗ | `docs/reviews/tz/` |
| Ревью архитектуры | `docs/reviews/architecture/` |
| Ревью плана | `docs/reviews/plans/` |
| Ревью кода | `docs/reviews/code/` |
| ADR | `docs/decisions/` |

Это создаёт однозначную трассируемость всех решений.

---

# 7. Как workflows работают вместе

Ниже — высокоуровневая схема (текстовая):

```
Task → Orchestrator → Auto-routing → Agent picks workflow → 
Creates artifact → Review Pipeline → Approve → Next stage
```

И более подробный вариант:

```
Idea / Requirement  
    ↓  
Requirements Analyst  
    ↓ (review-mode)
Approved TЗ  
    ↓  
Architect  
    ↓ (review-mode)
Approved Architecture  
    ↓  
Planner  
    ↓ (review-mode)
Approved Plan  
    ↓  
Backend/Frontend Dev  
    ↓ (code-review)
Approved Code  
    ↓  
QA + Security  
    ↓  
Release
```

Workflow-логика обеспечивает отсутствие пропусков, логических дыр и архитектурных ошибок.

---

# 8. Обязанности агентов в рамках workflow

Каждый агент должен:

### 1. Читать workflows перед началом работы  
### 2. Не нарушать порядок работы  
### 3. Не игнорировать ревью-триггеры  
### 4. Сохранять все результаты  
### 5. Уважать ADR — архитектурные решения имеют силу закона  
### 6. Не добавлять новые директории без ADR-решения

---

# 9. Definition of Done (DoD) — интегрировано в workflows

Задача НЕ считается завершённой, если:

- отсутствует ревью-файл (если ревью требуется),
- документация не обновлена,
- ADR не обновлён при необходимости,
- есть логические ошибки между ТЗ → архитектура → план,
- нет тестов или нет возможности протестировать,
- нарушены принципы microservices boundary.

---

# 10. Использование workflows в Cursor

Cursor должен:

1. Автоматически проверять виды артефактов и выбирать нужный workflow-файл.  
2. Включать review-режим после создания артефакта.  
3. Запрашивать ревью перед завершением задач.  
4. Отказаться от выполнения задачи, если не хватает контекста.  
5. Всегда сверяться с ADR и архитектурой перед изменениями.

---

# 11. Заключение

`docs/ai/workflows.md` является основным документом, который объясняет:

- **как работает мультиагентная разработка Go2Asia**,  
- **какие правила обязательны для всех агентов**,  
- **как двигается работа от идеи до релиза**.

Использование этого документа — ключ к стабильной, предсказуемой и масштабируемой разработке.

