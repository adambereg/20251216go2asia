# Caching & Performance — Кеширование и производительность Go2Asia

Этот документ описывает стратегию кеширования и подходы к оптимизации производительности.

---

## 1. Цели

- Обеспечить быструю загрузку PWA и ключевых страниц.
- Минимизировать задержки при работе с API.
- Снизить нагрузку на backend и БД.
- Подготовиться к росту трафика.

---

## 2. Уровни кеширования

1. **CDN/Edge-кеш**
   - Статика (JS/CSS/изображения).
   - Часть публичных API (например, Atlas/Blog для анонимных пользователей) может отдавать кэшируемые ответы.

2. **Клиент-кеш (браузер/PWA)**
   - HTTP-кеш (ETag/Last-Modified).
   - In-memory кеш на фронтенде:
     - повторное использование данных (например, список стран, городов).

3. **Backend-кеш**
   - Кеширование «тяжёлых» запросов:
     - популярные места,
     - подборки,
     - агрегированные данные.
   - Использование in-memory кеша или внешнего кеш-хранилища (Redis-подобные решения).

4. **БД-уровень**
   - Индексы.
   - Оптимизация запросов.
   - Разделение нагрузки по схемам и сервисам.

---

## 3. Что кешируем в первую очередь

- Atlas:
  - список стран, городов, базовые данные о местах;
- Blog:
  - ленты популярных/последних статей;
- Pulse:
  - ближайшие события в популярных городах.

---

## 4. Что не кешируем (или кешируем аккуратно)

- Персонализированные данные (баланс Points, личные квесты, личные рекомендации).
- Чувствительные данные (профиль пользователя, реферальные структуры, on-chain операции).

---

## 5. Performance-подходы на фронтенде

- Code splitting и lazy-loading модулей.
- Использование skeleton-экранов и оптимистичного UI там, где возможно.
- Минимизация количества запросов при первом рендере.
- Использование пагинации/ленивой подгрузки для длинных списков (места, объявления, статьи).

---

## 6. Performance-подходы на backend

- Оптимизация запросов к БД и индексов.
- Асинхронная обработка тяжёлых операций (уведомления, аналитика, частично AI).
- Кеширование результатов повторяющихся запросов.
- Разделение read/write нагрузки при росте.

---

## 7. Мониторинг и алертинг

- Метрики:
  - время ответа API,
  - количество ошибок (5xx/4xx),
  - latency на уровне Gateway и отдельных сервисов.
- Алерты:
  - резкий скачок ошибок;
  - рост времени ответа;
  - деградация отдельных endpoint-ов.

---

## 8. Связанные документы

- `architecture/system_architecture.md`
- `architecture/be_architecture.md`
- `architecture/data_flow.md`
