# API Architecture ‚Äî –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ API Go2Asia

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç, –∫–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω—ã –≤–Ω–µ—à–Ω–∏–µ –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ API, –∏—Ö –ø—Ä–∏–Ω—Ü–∏–ø—ã –∏ –ø—Ä–∞–≤–∏–ª–∞.

---

## 1. –û–±—â–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

- **API-first:** –∫–∞–∂–¥—ã–π –º–æ–¥—É–ª—å –∏–º–µ–µ—Ç —á—ë—Ç–∫–æ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π API.
- **RESTful —Å—Ç–∏–ª—å:** –±–∞–∑–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç ‚Äî JSON –ø–æ–≤–µ—Ä—Ö HTTP.
- **–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:** `/api/v1/...` —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –≤–≤–æ–¥–∞ `/api/v2/...`.
- **–Ø—Å–Ω—ã–µ –Ω–µ–π–º–∏–Ω–≥–∏:** —Ä–µ—Å—É—Ä—Å—ã –≤–æ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —á–∏—Å–ª–µ: `/places`, `/events`, `/articles`.
- **–ß—ë—Ç–∫–∞—è –º–æ–¥–µ–ª—å –æ—à–∏–±–æ–∫:** –∫–æ–¥ + —Ç–∏–ø + —Å–æ–æ–±—â–µ–Ω–∏–µ.

---

## 2. –í–Ω–µ—à–Ω–∏–π –ø—É–±–ª–∏—á–Ω—ã–π API (–¥–ª—è PWA –∏ —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤)

–ë–∞–∑–æ–≤—ã–π –ø—Ä–µ—Ñ–∏–∫—Å:
- `https://go2asia.app/api/v1/`

–ü—Ä–∏–º–µ—Ä—ã:
- Atlas:
  - `GET /api/v1/atlas/countries`
  - `GET /api/v1/atlas/cities?country=vn`
  - `GET /api/v1/atlas/places/{id}`
- Pulse:
  - `GET /api/v1/events`
  - `GET /api/v1/events/{id}`
- Blog:
  - `GET /api/v1/articles`
  - `GET /api/v1/articles/{slug}`

–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:
- —á–µ—Ä–µ–∑ Bearer —Ç–æ–∫–µ–Ω (JWT).

---

## 3. –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Å–µ—Ä–≤–∏—Å–Ω—ã–π API

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–±—â–µ–Ω–∏—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤:
- –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –¥–æ–º–µ–Ω/—Å–µ—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, `http://atlas-service:3000/internal/...`).
- –ú–æ–∂–µ—Ç –∏–º–µ—Ç—å –±–æ–ª–µ–µ –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π –∫–æ–Ω—Ç—Ä–∞–∫—Ç.
- –î–æ—Å—Ç—É–ø –æ–≥—Ä–∞–Ω–∏—á–µ–Ω —Å–µ—Ç–µ–≤—ã–º —É—Ä–æ–≤–Ω–µ–º + —Å–µ—Ä–≤–∏—Å–Ω—ã–º–∏ —Å–µ–∫—Ä–µ—Ç–∞–º–∏.

---

## 4. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞ –∏ –æ—à–∏–±–æ–∫

### 4.1. –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç (–ø—Ä–∏–º–µ—Ä)

```json
{
  "data": { ... },
  "meta": {
    "request_id": "uuid",
    "timestamp": "2025-01-01T12:00:00Z"
  }
}

### 4.2. –û—à–∏–±–∫–∞

{
  "error": {
    "code": "VALIDATION_ERROR",
    "http_status": 400,
    "message": "–ü–æ–ª–µ city_id –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ",
    "details": { ... }
  }
}

## 5. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è OpenAPI/Swagger —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–π.
- –ü—É–±–ª–∏–∫–∞—Ü–∏—è:
  - –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è (–¥–ª—è –∫–æ–º–∞–Ω–¥—ã);
  - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ ‚Äî –ø—É–±–ª–∏—á–Ω—ã–π –¥–µ–≤-–ø–æ—Ä—Ç–∞–ª.

## 6. –†–æ–ª–∏ –∏ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

- –û–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –Ω–∞ —É—Ä–æ–≤–Ω–µ JWT-–∫–ª–µ–π–º–æ–≤ –∏ —Ä–æ–ª–µ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã:
  - GUEST (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø),
  - USER,
  - VIP,
  - PRO,
  - PARTNER,
  - ADMIN.
- –ö–∞–∂–¥–∞—è —Ä–æ–ª—å –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–º –º–∞—Ä—à—Ä—É—Ç–∞–º/–æ–ø–µ—Ä–∞—Ü–∏—è–º.

## 7. –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- architecture/system_architecture.md
- architecture/be_architecture.md
- architecture/data_flow.md
- architecture/microservices.md

---

## üìÑ `architecture/data_flow.md`

```md
# Data Flow ‚Äî –ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤ —ç–∫–æ—Å–∏—Å—Ç–µ–º–µ Go2Asia

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Ç–∏–ø–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ —É—Ä–æ–≤–Ω–∏ —Å–∏—Å—Ç–µ–º—ã.

---

## 1. –¢–∏–ø–æ–≤–æ–π read-–ø–æ—Ç–æ–∫ (–ø—Ä–æ—Å–º–æ—Ç—Ä –º–µ—Å—Ç–∞ –≤ Atlas)

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å—Ç—Ä–∞–Ω–∏—á–∫—É –º–µ—Å—Ç–∞ –≤ –º–æ–¥—É–ª–µ **Atlas**.
2. –§—Ä–æ–Ω—Ç–µ–Ω–¥ –≤—ã–∑—ã–≤–∞–µ—Ç `GET /api/v1/atlas/places/{id}`.
3. Edge/API Gateway:
   - –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Ç–æ–∫–µ–Ω;
   - –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å –≤ Atlas Service.
4. Atlas Service:
   - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–µ—à (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω);
   - –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ ‚Äî –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ –ë–î PostgreSQL;
   - –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥–æ–≥—Ä—É–∂–∞–µ—Ç —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏ (–≥–æ—Ä–æ–¥, —Å—Ç—Ä–∞–Ω–∞, —Å–≤—è–∑–∞–Ω–Ω—ã–µ RF-–ø–∞—Ä—Ç–Ω—ë—Ä—ã).
5. –û—Ç–≤–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø–æ —Ü–µ–ø–æ—á–∫–µ ‚Üí —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ ‚Üí UI.

---

## 2. –¢–∏–ø–æ–≤–æ–π write-–ø–æ—Ç–æ–∫ (—Å–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –≤ Pulse PRO-–ø–∞—Ä—Ç–Ω—ë—Ä–æ–º)

1. PRO/Partner –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ñ–æ—Ä–º—É —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏—è.
2. –§—Ä–æ–Ω—Ç–µ–Ω–¥ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `POST /api/v1/events`.
3. Gateway:
   - –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç JWT;
   - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–æ–ª—å (PRO/Partner);
   - –ø–µ—Ä–µ–¥–∞—ë—Ç –∑–∞–ø—Ä–æ—Å –≤ Pulse Service.
4. Pulse Service:
   - –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ;
   - –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ –≤ –ë–î;
   - —Å–æ–∑–¥–∞—ë—Ç –∑–∞–ø–∏—Å—å –≤ Event-–ª–æ–≥ (–¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏/—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π).
5. Notification Service (–ø–æ —Å–æ–±—ã—Ç–∏—é):
   - –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å—á–∏–∫–∞–º/—É—á–∞—Å—Ç–Ω–∏–∫–∞–º.

---

## 3. –ü–æ—Ç–æ–∫ —Ç–æ–∫–µ–Ω–æ–º–∏–∫–∏ (–Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ Points –∑–∞ –¥–µ–π—Å—Ç–≤–∏–µ)

–ü—Ä–∏–º–µ—Ä: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—É–±–ª–∏–∫—É–µ—Ç –æ—Ç–∑—ã–≤.

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç–∑—ã–≤ —á–µ—Ä–µ–∑ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –º–æ–¥—É–ª—å (Atlas/Blog/Rielt).
2. –°–µ—Ä–≤–∏—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, Atlas Service) —Å–æ–∑–¥–∞—ë—Ç –æ—Ç–∑—ã–≤ –∏ –ø—É–±–ª–∏–∫—É–µ—Ç —Å–æ–±—ã—Ç–∏–µ `review_created`.
3. Points Service:
   - —Å–ª—É—à–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ;
   - –Ω–∞—á–∏—Å–ª—è–µ—Ç N Points –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é;
   - –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –≤ —Å–≤–æ—é –ë–î.
4. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–ø—Ä–æ—Å–µ –ø—Ä–æ—Ñ–∏–ª—è –≤–∏–¥–∏—Ç –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π –±–∞–ª–∞–Ω—Å Points.

---

## 4. –ü–æ—Ç–æ–∫ on-chain (—á–µ—Ä–µ–∑ Blockchain Gateway)

–ü—Ä–∏–º–µ—Ä: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ö–æ—á–µ—Ç –≤—ã–≤–µ—Å—Ç–∏ —á–∞—Å—Ç—å G2A-—Ç–æ–∫–µ–Ω–æ–≤ –Ω–∞ –±–ª–æ–∫—á–µ–π–Ω.

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç –≤—ã–≤–æ–¥ –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ.
2. Frontend –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `POST /api/v1/wallet/withdraw`.
3. Gateway ‚Üí Blockchain Gateway Service.
4. Blockchain Gateway Service:
   - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –±–∞–ª–∞–Ω—Å off-chain;
   - —Ä–µ–∑–µ—Ä–≤–∏—Ä—É–µ—Ç/—Å–ø–∏—Å—ã–≤–∞–µ—Ç –µ–≥–æ;
   - —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –≤ TON;
   - –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É ‚Üí –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å –æ–ø–µ—Ä–∞—Ü–∏–∏.

---

## 5. –ü–æ—Ç–æ–∫ AI-–∑–∞–ø—Ä–æ—Å–∞ (–ø—Ä–∏–º–µ—Ä: –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π –≥–∏–¥ –≤ Guru)

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–¥–∞—ë—Ç –≤–æ–ø—Ä–æ—Å ¬´—á—Ç–æ –ø–æ—Å–µ—Ç–∏—Ç—å –Ω–∞ –§—É–∫—É–æ–∫–µ –Ω–∞ 3 –¥–Ω—è¬ª.
2. –§—Ä–æ–Ω—Ç–µ–Ω–¥ –≤—ã–∑—ã–≤–∞–µ—Ç `POST /api/v1/guru/plan_trip`.
3. Guru Service:
   - –ø–æ–¥–≥—Ä—É–∂–∞–µ—Ç –º–µ—Å—Ç–∞/—Å–æ–±—ã—Ç–∏—è/–ø–∞—Ä—Ç–Ω—ë—Ä–æ–≤;
   - —Å–æ–±–∏—Ä–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç;
   - –≤—ã–∑—ã–≤–∞–µ—Ç AI Gateway —Å –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–º –ø—Ä–æ–º—Ç–æ–º;
   - –ø–æ–ª—É—á–∞–µ—Ç –æ—Ç–≤–µ—Ç –∏ —Å–µ—Ä–∏–∞–ª–∏–∑—É–µ—Ç –µ–≥–æ –≤–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç;
   - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É.

---

## 6. –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- `architecture/system_architecture.md`
- `architecture/api_architecture.md`
- `architecture/microservices.md`
- `architecture/caching_and_performance.md`
